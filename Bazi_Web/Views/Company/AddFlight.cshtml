@model Bazi_Web.Models.AddFlightViewModel
@using Db201617zVaProektRnabContext;
@{
    ViewBag.Title = "AddFlight";
}

<div class="page-header">
    <h2>Add Flight</h2>
</div>
@using (Html.BeginForm("AddFlight", "Company", FormMethod.Post))
{
<div class="row">
    <div class="col-md-6">
        <div class="panel panel-info">
            <div class="panel-body" id="FlightContainer">
            </div>
            <div class="panel-footer">
                <div class="row">
                    <input type="button" class="btn btn-primary col-md-offset-1 col-md-4" value="Add new flight part" id="AddSubFlightElement" />
                    <input type="button" class="btn btn-danger col-md-offset-2 col-md-4" value="Remove last sub flight" id="RemoveSubFlightElement" />
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="panel panel-info">
            <div class="panel-body" id="DepartContainer">
            </div>
            <div class="panel-footer">
                <div class="row">
                    <input type="button" class="btn btn-primary col-md-offset-1 col-md-4" value="Add departure" id="AddDepartElement" />
                    <input type="button" class="btn btn-danger col-md-offset-2 col-md-4" value="Remove last departure" id="RemoveDepartElement" />
                </div>
            </div>
        </div>
    </div>
</div>
<div class="">
    <input type="submit" class="btn-primary" value="Add Flight"/>
</div>
}


<script src="~/Scripts/jquery-1.10.2.min.js"></script>
<script type="text/javascript">
    var FlightIndex = parseInt(@Model.ListOfFlights.Count);

    $("#AddSubFlightElement").click(function () {

        $.ajax({
            cache: false,
            type: "GET",
            url: "/Company/SubFlight",
            data: {
                Index: FlightIndex
            },
            success: function (data) {
                $("#FlightContainer").append(data);
                FlightIndex = FlightIndex + 1;
            },
            error: function (xhr, ajaxOptions, thrownError) {

            }
        });
    });

    $("#RemoveSubFlightElement").click(function () {
        $('#group_' + (FlightIndex - 1).toString()).remove();
        if (FlightIndex != 0)
            FlightIndex = FlightIndex - 1;
    });

    var DepartIndex = parseInt(@Model.DepartureDays.Count);

    $("#AddDepartElement").click(function () {

        $.ajax({
            cache: false,
            type: "GET",
            url: "/Company/Departure",
            data: {
                Index: DepartIndex
            },
            success: function (data) {
                $("#DepartContainer").append(data);
                DepartIndex = DepartIndex + 1;
            },
            error: function (xhr, ajaxOptions, thrownError) {

            }
        });
    });

    $("#RemoveDepartElement").click(function () {
        $('#depart_' + (DepartIndex - 1).toString()).remove();
        if (DepartIndex != 0)
            DepartIndex = DepartIndex - 1;
    });
</script>